select b.INVOICENO, b.RECEIPTNO,(select SUM(a.AMOUNT) from ALL_CASHTRANSR a where a.RECEIPTNO = b.RECEIPTNO and a._UNITID = b._UNITID) ,b.AMOUNTTOPAY from ALL_CASHTRANSH b 
where (select SUM(a.AMOUNT) from ALL_CASHTRANSR a where a.RECEIPTNO = b.RECEIPTNO)  != b.AMOUNTTOPAY 

